"use strict";(self.webpackChunkaccounts_frontend=self.webpackChunkaccounts_frontend||[]).push([[940],{6940:function(e,t,r){r.r(t),r.d(t,{default:function(){return G}});var n=r(2791),a=r(6871),o=r(7436),i=r(3207),l=r(5861),s=r(885),c=r(7757),u=r.n(c),f=r(31),d=r(919),p=r(3014),m=r(184);var h=function(){var e=(0,n.useState)([]),t=(0,s.Z)(e,2),r=t[0],o=t[1],i=(0,n.useState)(),c=(0,s.Z)(i,2),h=c[0],y=c[1],v=(0,a.s0)(),b=(0,a.TH)();return(0,n.useEffect)((function(){var e=function(){var e=(0,l.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,f.Kl)();case 3:t=e.sent,o(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),o([]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:"p-3",children:[(0,m.jsx)("div",{className:"text-xl text-center my-2 font-semibold",children:"Invoice Upload"}),(0,m.jsxs)("div",{className:"flex gap-4 justify-center items-center border py-4",style:{maxHeight:"calc(100vh - 160px)"},children:[(0,m.jsx)("div",{children:(0,m.jsx)("label",{htmlFor:"invoiceUser",className:"block mb-2 text-lg font-medium",children:"Select user to upload invoices"})}),(0,m.jsx)("div",{className:"field w-1/3 max-w-1/3",children:(0,m.jsx)(p.L,{inputId:"invoiceUser",id:"invoiceUser",name:"invoiceUser",options:r,optionLabel:"username",optionValue:"_id",value:h,filter:!0,showClear:!0,filterBy:"username",filterPlaceholder:"Search user",onChange:function(e){y(e.target.value)},placeholder:"Select User",className:"p-inputtext-sm",style:{width:"100%"},resetFilterOnHide:!0})}),(0,m.jsx)(d.z,{icon:"pi pi-upload",label:"Upload",className:"p-button-raised p-button-sm",disabled:!h,onClick:function(){v({pathname:"/dialog/upload",search:"?type=invoice&userId="+h},{state:{backgroundLocation:b}})}})]})]})})},y=r(2982),v=r(5705),b=r(7953),x=r(1063);function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){return w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},w(e,t)}function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function S(e,t){if(t&&("object"===N(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function D(e){return D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},D(e)}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=D(e);if(t){var a=D(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return S(this,r)}}var T=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(o,e);var t,r,n,a=P(o);function o(){return j(this,o),a.apply(this,arguments)}return t=o,r&&g(t.prototype,r),n&&g(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(n.Component),O=r(7145);function R(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C(e,t)}function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function A(e,t){if(t&&("object"===F(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function H(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=_(e);if(t){var a=_(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return A(this,r)}}var B,E,L,M=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(i,e);var t,r,a,o=H(i);function i(){return R(this,i),o.apply(this,arguments)}return t=i,(r=[{key:"render",value:function(){return n.createElement("tr",null,this.props.children)}}])&&k(t.prototype,r),a&&k(t,a),Object.defineProperty(t,"prototype",{writable:!1}),i}(n.Component);L={style:null,className:null},(E="defaultProps")in(B=M)?Object.defineProperty(B,E,{value:L,enumerable:!0,configurable:!0,writable:!0}):B[E]=L;var V=r(3829),Z=r(1848),I=r(7201),U=r(5854);var z=function(){var e=(0,n.useState)([]),t=(0,s.Z)(e,2),r=t[0],a=t[1],o=(0,n.useState)(!1),c=(0,s.Z)(o,2),h=c[0],g=c[1],j=(0,n.useRef)(null),w=(0,n.useState)(void 0),N=(0,s.Z)(w,2),S=N[0],D=N[1],P=(0,n.useState)(0),R=(0,s.Z)(P,2),k=R[0],C=R[1],F=new Date;F.setHours(0,0,0,0);var A="".concat(F.getFullYear()-2,":").concat(F.getFullYear()),_=[{label:"All",value:"all"}].concat((0,y.Z)(i.OM)),H=(0,v.TA)({initialValues:{invcType:i.us.Sales,fromDate:F,toDate:F},validationSchema:b.Ry({invcType:b.nK().oneOf(["all",i.us.Sales,i.us.Purchase,i.us.CRN_SR,i.us.DBN_PR]).required("Invoice Type is required"),fromDate:b.hT().nullable(),toDate:b.hT().nullable()}),onSubmit:function(){var e=(0,l.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B();case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()}),B=(0,n.useCallback)((0,l.Z)(u().mark((function e(){var t,r,n,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(H.isValid){e.next=2;break}return e.abrupt("return");case 2:return g(!0),e.prev=3,(t=Object.assign({},H.values)).toDate=t.toDate?t.toDate.toISOString():void 0,t.fromDate=t.fromDate?t.fromDate.toISOString():void 0,"all"==t.invcType&&delete t.invcType,e.next=10,(0,f.wc)(t);case 10:r=e.sent,n=r.data.map((function(e){return e.invcTypeName=(0,i.Pj)(e.invcType),e})),a(n),G(n),g(!1),e.next=25;break;case 17:e.prev=17,e.t0=e.catch(3),a([]),D(void 0),D(C),g(!1),o={title:"Error",message:e.t0,type:V.Xo.ERROR},(0,V.wp)(o);case 25:case"end":return e.stop()}}),e,null,[[3,17]])}))),[H.values,H.isValid]),E=function(e){return!(!H.touched[e]||!H.errors[e])},L=function(e){return E(e)&&(0,m.jsx)("small",{className:"p-error",children:H.errors[e]})},z=function(e,t){return(0,Z.dN)(e[t])},G=function(e){setTimeout((function(){var t;if((null===j||void 0===j||null===(t=j.current)||void 0===t?void 0:t.getRows())!=k){var r=e.reduce((function(e,t){return{amt:e.amt+t.invcAmt,tax:e.tax+t.taxAmt,gst:e.gst+t.gstAmt}}),{amt:0,tax:0,gst:0});if(0==r.amt&&0==r.tax&&0==r.gst)return D(void 0),void C(0);var n=(0,m.jsx)(T,{children:(0,m.jsxs)(M,{children:[(0,m.jsx)(x.s,{footer:"",colSpan:9,align:"right",style:{width:"72rem"}}),(0,m.jsx)(x.s,{footer:"".concat((0,Z.dN)(r.amt)),align:"right",style:{width:"7rem"}}),(0,m.jsx)(x.s,{footer:"".concat((0,Z.dN)(r.tax)),align:"right",style:{width:"7rem"}}),(0,m.jsx)(x.s,{footer:"".concat((0,Z.dN)(r.gst)),align:"right",style:{width:"7rem"}}),(0,m.jsx)(x.s,{footer:"",colSpan:9,align:"right",style:{width:"20rem"}})]})});D(n),C(e.length)}}),10)};return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"p-3",children:(0,m.jsx)("form",{className:"p-fluid",children:(0,m.jsxs)("div",{className:"flex gap-4",children:[(0,m.jsx)("div",{className:"w-3/4",children:(0,m.jsxs)("fieldset",{className:"border-2 rounded-md pb-2",children:[(0,m.jsx)("legend",{className:"ml-4 text-lg",children:"Invoice (GSTR2)"}),(0,m.jsxs)("div",{className:"flex gap-4 justify-center",children:[(0,m.jsxs)("div",{className:"field flex items-center gap-2 w-1/6 max-w-1/6",children:[(0,m.jsx)("label",{htmlFor:"invcType",className:"",children:"Type"}),(0,m.jsx)(p.L,{inputId:"invcType",id:"invcType",name:"invcType",options:_,optionLabel:"label",optionValue:"value",value:H.values.invcType,onChange:function(e){H.setFieldValue("invcType",e.value)},onBlur:H.handleBlur,placeholder:"Select Invoice Type",className:(0,U.AK)({"p-invalid":E("invcType"),"p-inputtext-sm":!0}),style:{width:"100%"}}),L("invcType")]}),(0,m.jsxs)("div",{className:"field flex items-center gap-2",children:[(0,m.jsx)("label",{htmlFor:"fromDate",className:"",children:"From Date"}),(0,m.jsx)(I.f,{name:"fromDate",id:"fromDate",value:H.values.fromDate,onChange:function(e){H.setFieldValue("fromDate",e.target.value)},onBlur:H.handleBlur,className:(0,U.AK)({"p-invalid":E("fromDate"),"p-inputtext-sm":!0}),placeholder:"From Date",dateFormat:"dd/mm/yy",maxDate:H.values.toDate,monthNavigator:!0,yearNavigator:!0,yearRange:A,mask:"99/99/9999",showOnFocus:!1}),L("fromDate")]}),(0,m.jsxs)("div",{className:"field flex items-center gap-2",children:[(0,m.jsx)("label",{htmlFor:"toDate",className:"",children:"To Date"}),(0,m.jsx)(I.f,{name:"toDate",id:"toDate",value:H.values.toDate,onChange:function(e){H.setFieldValue("toDate",e.target.value)},onBlur:H.handleBlur,className:(0,U.AK)({"p-invalid":E("toDate"),"p-inputtext-sm":!0}),placeholder:"To Date",dateFormat:"dd/mm/yy",minDate:H.values.fromDate,monthNavigator:!0,yearNavigator:!0,yearRange:A,mask:"99/99/9999",showOnFocus:!1}),L("toDate")]}),(0,m.jsx)("div",{className:"field flex items-center gap-2",children:(0,m.jsx)(d.z,{type:"button",label:"Search",className:"p-button-raised p-button-sm",onClick:H.submitForm,disabled:!H.isValid,icon:"pi pi-search"})})]})]})}),(0,m.jsxs)("div",{className:"w-1/4 flex items-center",children:[(0,m.jsx)(d.z,{type:"button",icon:"pi pi-refresh",label:"Refresh List",className:"p-button-raised p-button-sm !mr-2",onClick:function(){B()},loading:h}),(0,m.jsx)(d.z,{type:"button",icon:"pi pi-download",label:"Download",className:"p-button-raised p-button-sm !mr-2",onClick:function(){!function(){var e;null===j||void 0===j||null===(e=j.current)||void 0===e||e.exportCSV({selectionOnly:!1})}()}})]})]})})}),(0,m.jsx)("div",{className:"mx-3 card",style:{maxHeight:"calc(100vh - 160px)"},children:(0,m.jsxs)(O.w,{ref:j,loading:h,value:r,size:"small",showGridlines:!0,scrollable:!0,scrollDirection:"both",scrollHeight:"65vh",stripedRows:!0,removableSort:!0,paginator:!0,paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords}",rows:15,rowsPerPageOptions:[10,15,20],emptyMessage:"No Data Available",filterDisplay:"row",exportFilename:"invoices",onValueChange:G,footerColumnGroup:S,children:[(0,m.jsx)(x.s,{field:"invcTypeName",header:"Type",sortable:!0,style:{width:"6rem"}}),(0,m.jsx)(x.s,{field:"invcNo",header:"No",sortable:!0,filter:!0,filterPlaceholder:"Search by no",filterHeaderClassName:"p-inputtext-sm",showFilterMenu:!1,style:{width:"10rem"}}),(0,m.jsx)(x.s,{field:"invcDateUI",header:"Date",sortable:!0,body:function(e){return(0,Z.p6)(new Date(e.invcDate))},filter:!0,filterPlaceholder:"Search by date",filterHeaderClassName:"p-inputtext-sm",showFilterMenu:!1,style:{width:"8rem"}}),(0,m.jsx)(x.s,{field:"mode",header:"Mode",sortable:!0,style:{width:"5rem"}}),(0,m.jsx)(x.s,{field:"cr",header:"CR",sortable:!0,style:{width:"4rem"}}),(0,m.jsx)(x.s,{field:"code",header:"Code",sortable:!0,style:{width:"5rem"}}),(0,m.jsx)(x.s,{field:"name",header:"Name",sortable:!0,filter:!0,filterPlaceholder:"Search by name",filterHeaderClassName:"p-inputtext-sm",showFilterMenu:!1,style:{width:"12rem"}}),(0,m.jsx)(x.s,{field:"town",header:"Town",sortable:!0,style:{width:"10rem"}}),(0,m.jsx)(x.s,{field:"gst",header:"GST",sortable:!0,filter:!0,filterPlaceholder:"Search by gst",filterHeaderClassName:"p-inputtext-sm",showFilterMenu:!1,style:{width:"12rem"}}),(0,m.jsx)(x.s,{field:"invcAmt",header:"Amt",align:"right",alignHeader:"left",sortable:!0,body:function(e){return z(e,"invcAmt")},style:{width:"7rem"}}),(0,m.jsx)(x.s,{field:"taxAmt",header:"Tax Amt",align:"right",alignHeader:"left",sortable:!0,body:function(e){return z(e,"taxAmt")},style:{width:"7rem"}}),(0,m.jsx)(x.s,{field:"gstAmt",header:"GST Amt",align:"right",alignHeader:"left",sortable:!0,body:function(e){return z(e,"gstAmt")},style:{width:"7rem"}}),(0,m.jsx)(x.s,{field:"remarks",header:"Remarks",sortable:!0,filter:!0,filterPlaceholder:"Search by remarks",filterHeaderClassName:"p-inputtext-sm",showFilterMenu:!1,style:{width:"12rem"}}),(0,m.jsx)(x.s,{field:"month",header:"Month",sortable:!0,filter:!0,filterPlaceholder:"Search by Month",filterHeaderClassName:"p-inputtext-sm",showFilterMenu:!1,style:{width:"8rem"}})]})})]})};var G=function(e){var t,r=e.location,l=(0,n.useContext)(o.St);return(0,m.jsx)(a.Z5,{location:r,children:(0,m.jsx)(a.AW,{path:"/",element:(0,m.jsx)(a.j3,{}),children:(null===l||void 0===l||null===(t=l.user)||void 0===t?void 0:t.userType)===i.FW.Admin?(0,m.jsx)(a.AW,{index:!0,element:(0,m.jsx)(h,{})}):(0,m.jsx)(a.AW,{index:!0,element:(0,m.jsx)(z,{})})})})}}}]);
//# sourceMappingURL=940.85ebc3b1.chunk.js.map