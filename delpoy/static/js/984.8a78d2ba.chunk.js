"use strict";(self.webpackChunkaccounts_frontend=self.webpackChunkaccounts_frontend||[]).push([[984],{7699:function(e,r,t){t.d(r,{Fp:function(){return c},JS:function(){return n},Y_:function(){return i},bj:function(){return l},hQ:function(){return a}});var n="GROUP_LIST_REFRESH",a="ACCOUNT_LIST_REFRESH",i="TRANSACTION_LIST_REFRESH",c="BANK_TRANSACTION_LIST_REFRESH",l="USER_LIST_REFRESH"},3984:function(e,r,t){t.r(r),t.d(r,{default:function(){return F}});var n=t(2791),a=t(6871),i=t(8683),c=t(5861),l=t(885),s=t(7757),o=t.n(s),d=t(5705),u=t(7953),m=t(4286),p=t(919),h=t(9025),f=t(989),v=t(5854),x=t(3014),b=t(7201),j=t(31),A=t(3829),N=t(1848),g=t(7699),w=t(7436),D=t(7145),y=t(1063),R=t(184);var S=function(){var e,r,t,s,S=(0,a.UO)(),F=(0,a.s0)(),O=(0,n.useState)(!0),E=(0,l.Z)(O,2),C=E[0],k=E[1],T=(0,n.useState)(!0),_=(0,l.Z)(T,2),B=_[0],P=_[1],L=(0,n.useState)([]),Z=(0,l.Z)(L,2),q=Z[0],H=Z[1],I=(0,n.useContext)(w.Il),V=(0,n.useContext)(w.St),K=(0,n.useState)([]),Y=(0,l.Z)(K,2),U=Y[0],z=Y[1],W=(0,n.useRef)(),X=(0,n.useRef)(),G=(0,n.useRef)(),J=null!==V&&void 0!==V&&null!==(e=V.user)&&void 0!==e&&e.finYearStart?new Date(null===V||void 0===V||null===(r=V.user)||void 0===r?void 0:r.finYearStart):void 0,Q=null!==V&&void 0!==V&&null!==(t=V.user)&&void 0!==t&&t.finYearEnd?new Date(null===V||void 0===V||null===(s=V.user)||void 0===s?void 0:s.finYearEnd):void 0,M=new Date;M.setHours(0,0,0,0);var $=(0,d.TA)({initialValues:{_id:"",trnxDate:M,fromAcc:void 0,toAcc:void 0,desc:"",rno:"",received:0,paid:0},initialTouched:{trnxDate:!0},validationSchema:u.Ry().shape({trnxDate:u.hT().nullable().required("Transaction Date is required"),fromAcc:u.Z_().required("From account is requried"),toAcc:u.Z_().required("To account is requried").notOneOf([u.iH("fromAcc")],"To and From Account cannot be same"),desc:u.Z_().required("Description is required"),rno:u.Z_(),received:u.Rx().nullable(),paid:u.Rx().nullable()}).test((function(e,r){if(e.paid&&e.received){var t=[];return t.push(r.createError({message:"Should not enter both paid and received amounts",path:"received"})),t.push(r.createError({message:"Should not enter both paid and received amounts",path:"paid"})),new u.p8(t)}if(!e.paid&&!e.received){var n=[];return n.push(r.createError({message:"Received or Paid amount must be more than 0",path:"received"})),n.push(r.createError({message:"Received or Paid amount must be more than 0",path:"paid"})),new u.p8(n)}return!0})),onSubmit:function(){var e=(0,c.Z)(o().mark((function e(r,t){var n,a,i,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.setErrors,null===I||void 0===I||I.setDisplayLoader(!0),(n=Object.assign({},r)).paid=n.paid||0,n.received=n.received||0,e.prev=5,!B){e.next=14;break}return delete n._id,e.next=10,(0,j.jb)(n);case 10:a=e.sent,null===I||void 0===I||I.setDisplayLoader(!1),e.next=23;break;case 14:return i=n._id,delete n._id,e.next=18,(0,j.ew)(n,i);case 18:return a=e.sent,null===I||void 0===I||I.setDisplayLoader(!1),c={title:"Success",message:a.data.msg,type:A.Xo.SUCCESS,onClose:function(){ee(!0)}},(0,A.wp)(c),e.abrupt("return");case 23:n._id=a.data.id,z((function(e){return[].concat(e).concat([n])})),te(n),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(5),null===I||void 0===I||I.setDisplayLoader(!1),l={title:"Error",message:e.t0,type:A.Xo.ERROR},(0,A.wp)(l);case 33:case"end":return e.stop()}}),e,null,[[5,28]])})));return function(r,t){return e.apply(this,arguments)}}()});(0,n.useEffect)((function(){var e=function(){var e=(0,c.Z)(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,j.uj)();case 3:r=e.sent,H(r.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),H([]);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,n.useEffect)((function(){if(S.id){P(!1);var e=function(){var e=(0,c.Z)(o().mark((function e(){var r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,j.N3)(S.id);case 3:r=e.sent,$.setValues((0,i.Z)((0,i.Z)({},r.data),{},{trnxDate:new Date(r.data.trnxDate)})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),t={title:"Error",message:e.t0,type:A.Xo.ERROR},(0,A.wp)(t);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}else P(!0)}),[S.id,$.setValues]);var ee=function(e){e&&N.YB.dispatch(g.Fp),k(!1),F(-1)},re=(0,R.jsx)("div",{children:(0,R.jsx)(p.z,{label:"Close",icon:"pi pi-times",onClick:function(){return ee()}})}),te=function(e){var r=null!==e&&void 0!==e?e:$.values,t=r._id,n=r.fromAcc,a=r.trnxDate;$.resetForm({values:{_id:t,trnxDate:a,fromAcc:n,toAcc:void 0,desc:"",rno:"",received:0,paid:0},touched:{trnxDate:!0,fromAcc:!0}}),(0,N.Ev)(W)},ne=function(e){return!(!$.touched[e]||!$.errors[e])},ae=function(e){return ne(e)&&(0,R.jsx)("small",{className:"p-error",children:$.errors[e]})},ie=function(e,r){return e?(0,R.jsx)("span",{children:e.code+" - "+e.firmName}):(0,R.jsx)("span",{children:r.placeholder})},ce=function(e){return(0,R.jsx)("span",{children:e.code+" - "+e.firmName})},le=function(e,r){return(0,N.dN)(e[r])};return(0,R.jsx)(m.V,{visible:C,modal:!0,closeOnEscape:!1,header:"Bank Transaction - ".concat(B?"Create":"Edit"),footer:re,onHide:ee,style:{width:"100vw",height:"100vh"},blockScroll:!0,children:(0,R.jsxs)("div",{className:"p-2",children:[(0,R.jsx)("form",{className:"p-fluid",children:(0,R.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,R.jsxs)("div",{className:"field w-56",children:[(0,R.jsxs)("label",{htmlFor:"fromAcc",className:"block mb-2",children:[(0,R.jsx)("span",{className:"text-[#e24c4c]",children:"*"}),"From Account"]}),(0,R.jsx)(x.L,{inputId:"fromAcc",id:"fromAcc",name:"fromAcc",options:q,optionLabel:"firmName",optionValue:"code",value:$.values.fromAcc,filter:!0,showClear:!0,filterBy:"code,firmName",filterPlaceholder:"Search group code or name",onChange:function(e){$.setFieldValue("fromAcc",e.value)},onBlur:$.handleBlur,placeholder:"Select Account",valueTemplate:ie,itemTemplate:ce,required:!0,className:(0,v.AK)({"p-invalid":ne("fromAcc"),"p-inputtext-sm":!0}),style:{width:"100%"},disabled:!B,resetFilterOnHide:!0,ref:W,autoFocus:!0}),ae("fromAcc")]}),(0,R.jsxs)("div",{className:"field w-56",children:[(0,R.jsxs)("label",{htmlFor:"trnxDate",className:"block mb-2",children:[(0,R.jsx)("span",{className:"text-[#e24c4c]",children:"*"}),"Date"]}),(0,R.jsx)(b.f,{name:"trnxDate",id:"trnxDate",value:$.values.trnxDate,onChange:function(e){$.setFieldValue("trnxDate",e.target.value)},onSelect:function(){(0,N.Ev)(G)},onBlur:$.handleBlur,className:(0,v.AK)({"p-invalid":ne("trnxDate"),"p-inputtext-sm":!0}),placeholder:"Trnx. Date",required:!0,dateFormat:"dd/mm/yy",minDate:J,maxDate:Q,monthNavigator:!0,yearNavigator:!0,yearRange:"".concat(null===J||void 0===J?void 0:J.getFullYear(),":").concat(null===Q||void 0===Q?void 0:Q.getFullYear()),mask:"99/99/9999",ref:X,showOnFocus:!1}),ae("trnxDate")]}),(0,R.jsxs)("div",{className:"field w-56",children:[(0,R.jsxs)("label",{htmlFor:"toAcc",className:"block mb-2",children:[(0,R.jsx)("span",{className:"text-[#e24c4c]",children:"*"}),"To Account"]}),(0,R.jsx)(x.L,{inputId:"toAcc",id:"toAcc",name:"toAcc",options:q,optionLabel:"firmName",optionValue:"code",value:$.values.toAcc,filter:!0,showClear:!0,filterBy:"code,firmName",filterPlaceholder:"Search group code or name",onChange:function(e){$.setFieldValue("toAcc",e.value)},onBlur:$.handleBlur,placeholder:"Select Account",valueTemplate:ie,itemTemplate:ce,required:!0,className:(0,v.AK)({"p-invalid":ne("toAcc"),"p-inputtext-sm":!0}),style:{width:"100%"},resetFilterOnHide:!0,ref:G}),ae("toAcc")]}),(0,R.jsxs)("div",{className:"field w-56",children:[(0,R.jsxs)("label",{htmlFor:"desc",className:"block mb-2",children:[(0,R.jsx)("span",{className:"text-[#e24c4c]",children:"*"}),"Description"]}),(0,R.jsx)(h.o,{type:"text",name:"desc",id:"desc",value:$.values.desc,onChange:$.handleChange,onBlur:$.handleBlur,className:(0,v.AK)({"p-invalid":ne("desc"),"p-inputtext-sm":!0}),placeholder:"Description",required:!0,maxLength:10}),ae("desc")]}),(0,R.jsxs)("div",{className:"field w-56",children:[(0,R.jsx)("label",{htmlFor:"rno",className:"block mb-2",children:"Receipt No"}),(0,R.jsx)(h.o,{type:"text",name:"rno",id:"rno",value:$.values.rno,onChange:$.handleChange,onBlur:$.handleBlur,className:(0,v.AK)({"p-invalid":ne("rno"),"p-inputtext-sm":!0}),placeholder:"Receipt No",maxLength:10}),ae("rno")]}),(0,R.jsxs)("div",{className:"field w-40",children:[(0,R.jsxs)("label",{htmlFor:"received",className:"block mb-2",children:[(0,R.jsx)("span",{className:"text-[#e24c4c]",children:"*"}),"Received Amount"]}),(0,R.jsx)(f.R,{id:"received",name:"received",value:$.values.received,onValueChange:$.handleChange,onBlur:$.handleBlur,className:(0,v.AK)({"p-invalid":ne("received"),"p-inputtext-sm":!0}),placeholder:"Received Amount",mode:"decimal",maxFractionDigits:2,min:0,max:1e7,locale:"en-IN",required:!0}),ae("received")]}),(0,R.jsxs)("div",{className:"field w-40",children:[(0,R.jsxs)("label",{htmlFor:"paid",className:"block mb-2",children:[(0,R.jsx)("span",{className:"text-[#e24c4c]",children:"*"}),"Paid Amount"]}),(0,R.jsx)(f.R,{id:"paid",name:"paid",value:$.values.paid,onValueChange:$.handleChange,onBlur:$.handleBlur,className:(0,v.AK)({"p-invalid":ne("paid"),"p-inputtext-sm":!0}),placeholder:"Paid Amount",mode:"decimal",maxFractionDigits:2,min:0,max:1e7,locale:"en-IN",required:!0}),ae("paid")]}),(0,R.jsxs)("div",{className:"field w-32",children:[(0,R.jsx)("label",{className:"block invisible",children:"."}),(0,R.jsx)(p.z,{type:"button",label:"Save",icon:"pi pi-save",onClick:$.submitForm})]})]})}),U.length>0&&(0,R.jsx)("div",{children:(0,R.jsxs)(D.w,{value:U,size:"small",responsiveLayout:"scroll",showGridlines:!0,scrollable:!0,scrollHeight:"35vh",stripedRows:!0,children:[(0,R.jsx)(y.s,{field:"fromAcc",header:"From Acc"}),(0,R.jsx)(y.s,{field:"trnxDate",header:"Trnx. Date",body:function(e){return(0,N.p6)(new Date(e.trnxDate))}}),(0,R.jsx)(y.s,{field:"toAcc",header:"To Acc"}),(0,R.jsx)(y.s,{field:"desc",header:"Description"}),(0,R.jsx)(y.s,{field:"rno",header:"Receipt"}),(0,R.jsx)(y.s,{field:"received",header:"Received",align:"right",alignHeader:"left",body:function(e){return le(e,"received")}}),(0,R.jsx)(y.s,{field:"paid",header:"Paid",align:"right",alignHeader:"left",body:function(e){return le(e,"paid")}})]})})]})})};var F=function(){return(0,R.jsx)(a.Z5,{children:(0,R.jsxs)(a.AW,{path:"/",element:(0,R.jsx)(a.j3,{}),children:[(0,R.jsx)(a.AW,{path:"create",element:(0,R.jsx)(S,{})}),(0,R.jsx)(a.AW,{path:"edit/:id",element:(0,R.jsx)(S,{})})]})})}},8683:function(e,r,t){function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){n(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}t.d(r,{Z:function(){return i}})}}]);
//# sourceMappingURL=984.8a78d2ba.chunk.js.map